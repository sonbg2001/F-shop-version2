<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - F-Shop</title>

    <!-- Google Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Titillium+Web:400,200,300,700,600' rel='stylesheet'
        type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:400,100' rel='stylesheet' type='text/css'>

    <!-- Google Materrial - Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <!-- Font awesome cdn -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Css -->
    <link rel="shortcut icon" href="assets/images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="assets/css/style.css">

</head>

<body>
    <div id="wrapper">
        <div id="header" class="header"></div>
        <section id="product" class="product">
            <div class="product-container">
                <div class="product-top">
                    <div class="product-top-title">
                        <h3 class="heading-page">
                            <a href="index.html">Trang chủ</a> / <span>Sản phẩm</span>
                        </h3>
                    </div>
                    <div class="product-top-sort-by">
                        <div class="product-top-sort-by-title">
                            <h3>Sắp xếp:</h3>
                        </div>
                        <div class="product-top-sort-by-select">
                            <select name="sort-by" id="sort-by">
                                <option value="">Mặc định</option>
                                <option value="">Tên (A - Z)</option>
                                <option value="">Tên (Z - A)</option>
                                <option value="">Giá (Thấp &gt; Cao)</option>
                                <option value="">Giá (Cao &gt; Thấp)</option>
                                <option value="">Mới nhất</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="product-body">
                    <div class="product-body-filter">
                        <div class="product-body-filter-title">
                            <h3>Bộ lọc:</h3>
                        </div>
                        <div class="product-body-filter-select">
                            <select name="filter" id="filter">
                                <option value="">Tất cả</option>
                                <option value="">Áo phông</option>
                                <option value="">Quần</option>
                                <option value="">Giày</option>
                            </select>
                        </div>
                        <div class="product-body-filter-brand">
                            <h3>Thương hiệu</h3>
                            <div class="product-body-filter-brand-list">
                                <ul>
                                    <li>
                                        <input type="checkbox" id="brand-1" name="brand-1" />
                                        <label for="brand-1">Thương hiệu 1</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="brand-2" name="brand-2" />
                                        <label for="brand-2">Thương hiệu 2</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="brand-3" name="brand-3" />
                                        <label for="brand-3">Thương hiệu 3</label>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-body-filter-price">
                            <h3>Giá</h3>
                            <div class="product-body-filter-price-list">
                                <ul>
                                    <li>
                                        <input type="checkbox" id="price-1" name="price-1" />
                                        <label for="price-1">0đ - 100.000đ</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="price-2" name="price-2" />
                                        <label for="price-2">100.000đ - 200.000đ</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="price-3" name="price-3" />
                                        <label for="price-3">200.000đ - 300.000đ</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="price-4" name="price-4" />
                                        <label for="price-4">300.000đ - 500.000đ</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="price-5" name="price-5" />
                                        <label for="price-5">500.000đ - 800.000đ</label>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-body-filter-size">
                            <h3>Kích thước</h3>
                            <div class="product-body-filter-size-list">
                                <ul>
                                    <li>
                                        <input type="checkbox" id="size-1" name="size-1" />
                                        <label for="size-1">XS</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="size-2" name="size-2" />
                                        <label for="size-2">S</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="size-3" name="size-3" />
                                        <label for="size-3">M</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="size-4" name="size-4" />
                                        <label for="size-4">L</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="size-5" name="size-5" />
                                        <label for="size-5">XL</label>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-body-filter-color">
                            <h3>Màu</h3>
                            <div class="product-body-filter-color-list">
                                <ul>
                                    <li>
                                        <input type="checkbox" id="color-1" name="color-1" />
                                        <label for="color-1">Đỏ</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="color-2" name="color-2" />
                                        <label for="color-2">Xanh lam</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="color-3" name="color-3" />
                                        <label for="color-3">Xanh lá</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="color-4" name="color-4" />
                                        <label for="color-4">Vàng</label>
                                    </li>
                                    <li>
                                        <input type="checkbox" id="color-5" name="color-5" />
                                        <label for="color-5">Đen</label>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-body-filter-button">
                            <button type="submit" class="btn btn-cart">Lọc</button>
                        </div>
                    </div>
                    <div id="product-body-list">

                    </div>
                </div>
            </div>
        </section>
        <div id="footer" class="footer"></div>
    </div>

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script>
        function cartPage() {
            window.location.href = "cart.html";
        }

        $(document).ready(function () {
            $("#header").load("header.html");
            $("#footer").load("footer.html");
        });

        // products and products-Storage
    

        let dataProducts = `[
            {
                "id": 1,
                "name": "Áo thun nữ mỏng",
                "price": 37,
                "discount": 15,
                "type": "shirt",
                "description": "Áo thun in tay lỡ nữ freesize phông form rộng dáng Unisex - Ulzzang mặc cặp, nhóm, lớp hình BƯỚM MISSOUT BUTTERFLY",
                "image": "assets/images/ao1.webp"
            },
            {
                "id": 2,
                "name": "Áo phông nữ cộc tay",
                "price": 37,
                "discount": 15,
                "type": "shirt",
                "description": "Áo thun nữ ,áo phông nữ cộc tay phối cổ dáng rộng 3 màu cực xinh",
                "image": "assets/images/ao2.webp"
            },
            {
                "id": 3,
                "name": "Áo thun bóng rổ nữ",
                "price": 62,
                "discount": 8,
                "type": "shirt",
                "description": "Áo thun bóng rổ nữ - áo phông cộc tay phom rộng in số 11 phong cách hàn quốc",
                "image": "assets/images/ao3.webp"
            },
            {
                "id": 4,
                "name": "Áo thun bóng rổ nữ",
                "price": 62,
                "discount": 8,
                "type": "shirt",
                "description": "Áo thun bóng rổ nữ - áo phông cộc tay phom rộng in số 11 phong cách hàn quốc",
                "image": "assets/images/ao4.webp"
            },
            {
                "id": 5,
                "name": "Áo thun unisex",
                "price": 340,
                "discount": 20,
                "type": "shirt",
                "description": "Áo thun unisex Khổng Hiền from rộng cổ tròn tay lỡ freesize 38-70kg - LAVE OFF",
                "image": "assets/images/ao5.webp"
            },
            {
                "id": 6,
                "name": "Áo phông tay lỡ",
                "price": 340,
                "discount": 22,
                "type": "shirt",
                "description": "Áo phông, Áo thun unisex from rộng cổ tròn tay lỡ freesize 38-70kg Tim nhỏ",
                "image": "assets/images/ao6.webp"
            },
            {
                "id": 7,
                "name": "Áo thun unisex",
                "price": 240,
                "discount": 18,
                "type": "shirt",
                "description": "Áo phông, Áo thun unisex from rộng cổ tròn tay lỡ freesize 38-70kg Ghost",
                "image": "assets/images/ao7.webp"
            },
            {
                "id": 8,
                "name": "Áo thun unisex Khổng Hiền",
                "price": 566,
                "discount": 48,
                "type": "shirt",
                "description": "Áo thun unisex Khổng Hiền from rộng cổ tròn tay lỡ freesize 38-70kg thun trắng",
                "image": "assets/images/ao8.webp"
            },
            {
                "id": 9,
                "name": "Áo phông rộng freesize",
                "price": 345,
                "discount": 32,
                "type": "shirt",
                "description": "Áo phông rộng freesize nam nữ unisex chất đẹp from chuẩn",
                "image": "assets/images/ao9.webp"
            },
            {
                "id": 10,
                "name": "ÁO SMOCKING KATE",
                "price": 500,
                "discount": 22,
                "type": "shirt",
                "description": "ÁO SMOCKING KATE CAO CẤP SEXY",
                "image": "assets/images/ao10.webp"
            },
            {
                "id": 11,
                "name": "Quần ống rộng nữ 1 cúc",
                "price": 390,
                "discount": 6,
                "type": "trousers",
                "description": "Quần ống rộng nữ 1 cúc trước chất tuyết mưa nhiều màu tự nhiên",
                "image": "assets/images/quan1.webp"
            },
            {
                "id": 12,
                "name": "Quần bò ống rộng nữ cạp cao",
                "price": 103,
                "discount": 23,
                "type": "trousers",
                "description": "Quần bò ống rộng nữ cạp cao, quần jeans ống rộng lưng cao, dáng suông baggy ống đứng, kiểu ulzzang Cherry T008",
                "image": "assets/images/quan2.webp"
            },
            {
                "id": 13,
                "name": "Quần jean nữ co dãn Julido Store",
                "price": 139,
                "discount": 16,
                "type": "trousers",
                "description": "Quần jean nữ co dãn Julido Store, lưng cao mẫu mới màu đen JD8888",
                "image": "assets/images/quan3.webp"
            },
            {
                "id": 14,
                "name": "Quần jean nữ lưng cao Julido",
                "price": 126,
                "discount": 22,
                "type": "trousers",
                "description": "Quần jean nữ lưng cao Julido, chất jean cotton co dãn tôn dáng phụ nữ eo thon mẫu KV03A",
                "image": "assets/images/quan4.webp"
            },
            {
                "id": 15,
                "name": "Quần giả váy nữ ngắn vạt lệch đính cúc",
                "price": 250,
                "discount": 21,
                "type": "trousers",
                "description": "Quần giả váy nữ ngắn vạt lệch đính cúc, Quần đùi giả váy vạt lệch",
                "image": "assets/images/quan5.webp"
            },
            {
                "id": 16,
                "name": "Quần yếm kaki Banamo fashion",
                "price": 225,
                "discount": 27,
                "type": "trousers",
                "description": "Quần yếm kaki Banamo fashion ống rộng dáng dài phối túi ngực màu be phong cách hàn quốc quần yếm kaki 565",
                "image": "assets/images/quan6.webp"
            },
            {
                "id": 17,
                "name": "Quần đùi nữ cạp chun RÚT DÂY",
                "price": 170,
                "discount": 10,
                "type": "trousers",
                "description": "Quần đùi nữ cạp chun RÚT DÂY <55kg vải thun cotton short hot tiktok sooc cạp cao thể thao sexy aomi",
                "image": "assets/images/quan7.webp"
            },
            {
                "id": 18,
                "name": "Quần yếm nữ King168",
                "price": 180,
                "discount": 5,
                "type": "trousers",
                "description": "Quần yếm nữ King168, yếm short nữ co dãn nhẹ mẫu mới DC13",
                "image": "assets/images/quan8.webp"
            },
            {
                "id": 19,
                "name": "Quần Jean Nữ Lưng Cao thương hiệu Chandi",
                "price": 290,
                "discount": 33,
                "type": "trousers",
                "description": "Quần Jean Nữ Lưng Cao thương hiệu Chandi, chất jean cotton co dãn tôn dáng phụ nữ eo thon mẫu KV617",
                "image": "assets/images/quan9.webp"
            },
            {
                "id": 20,
                "name": "Quần short jean nữ lưng cao phối rách denim cotton",
                "price": 300,
                "discount": 50,
                "type": "trousers",
                "description": "Quần short jean nữ lưng cao phối rách denim cotton, rin ngắn phối rách William - AT87",
                "image": "assets/images/quan10.webp"
            },
            {
                "id": 21,
                "name": "Giày thể thao nữ GB2.5",
                "price": 227,
                "discount": 12,
                "type": "shoes",
                "description": "Giày thể thao nữ đi êm chân - GB2.5",
                "image": "assets/images/giay1.webp"
            },
            {
                "id": 22,
                "name": "Giày nữ thấp cổ thêu hoa",
                "price": 160,
                "discount": 17,
                "type": "shoes",
                "description": "Giày nữ thấp cổ thêu hoa cúc siêu đáng yêu",
                "image": "assets/images/giay2.webp"
            },
            {
                "id": 23,
                "name": "GIÀY NỮ | GIÀY THỂ THAO",
                "price": 550,
                "discount": 14,
                "type": "shoes",
                "description": "GIÀY NỮ | GIÀY THỂ THAO & THỜI TRANG",
                "image": "assets/images/giay3.webp"
            },
            {
                "id": 24,
                "name": "GIÀY SNEAKERS NỮ",
                "price": 250,
                "discount": 12,
                "type": "shoes",
                "description": "GIÀY SNEAKERS NỮ KIỂU DÁNG TRẺ TRUNG THANH LỊCH",
                "image": "assets/images/giay4.webp"
            },
            {
                "id": 25,
                "name": "Giày thể thao nữ phong cách Hàn quốc",
                "price": 524,
                "discount": 25,
                "type": "shoes",
                "description": "Giày thể thao nữ đế dày phong cách Hàn quốc mẫu mới nhất 2020 siêu đẹp",
                "image": "assets/images/giay5.webp"
            },
            {
                "id": 26,
                "name": "Giày Biti's DSM074400XNH",
                "price": 330,
                "discount": 3,
                "type": "shoes",
                "description": "Giày Thể Thao Trung Cấp Nam Biti's DSM074400XNH",
                "image": "assets/images/giay6.webp"
            },
            {
                "id": 27,
                "name": "Giày Nam Trắng các loại",
                "price": 204,
                "discount": 10,
                "type": "shoes",
                "description": "Giày Nam Thể Thao Nam Nữ Thời Trang (Trắng các loại)",
                "image": "assets/images/giay7.webp"
            },
            {
                "id": 28,
                "name": "Giày nam K99",
                "price": 270,
                "discount": 11,
                "type": "shoes",
                "description": "Giày thể thao nam, giày nam da lộn K99",
                "image": "assets/images/giay8.webp"
            },
            {
                "id": 29,
                "name": "Giày Nam Sneaker Live Running",
                "price": 298,
                "discount": 6,
                "type": "shoes",
                "description": "Giày Thể Thao Nam Sneaker Live Running Độn Gót Tăng Chiều Cao 5cm Cao Cấp Tặng Kèm Đồng Hồ Đeo Tay Nam Thời Trang",
                "image": "assets/images/giay9.webp"
            },
            {
                "id": 30,
                "name": "Giày thể thao nam XD21",
                "price": 319,
                "discount": 26,
                "type": "shoes",
                "description": "Giày thể thao nam, giày sneaker nam da Xám - Trắng (2 màu) XD21",
                "image": "assets/images/giay10.webp"
            }
        ]`;

        let products;
        if(localStorage.getItem("products") === null) {
            products = JSON.parse(dataProducts);
            localStorage.setItem("products", JSON.stringify(products));
        } else {
            products = JSON.parse(localStorage.getItem("products"));
        }

        // products-Storage

        console.log(products);
        function displayProducts() {
            let html = "";
            for (let i = 0; i < products.length; i++) {
                let totalsale = products[i].price - products[i].price * products[i].discount / 100;
                totalsale = totalsale.toFixed(3);
                // totalsale = totalsale.toLocaleString('it-IT', {style : 'currency', currency : 'VND'});
                html += `
                <div id="${products[i].id}" class="product-body-list-item">
                    <div class="product-body-list-item-image">
                        <img src="${products[i].image}" height = "80" alt="">
                    </div>
                    <div class="product-body-list-item-title">
                        <h4 onclick="viewProduct(${products[i].id})">${products[i].name}</h4>
                    </div>
                    <div class="product-body-list-item-discount">
                        <p>Giảm ${products[i].discount}%</p>
                    </div>
                    <div class="product-body-list-item-price">
                        <h4><span>${products[i].price}.000đ</span> ${totalsale}đ</h4>
                    </div>
                    <div class="product-body-list-item-button">
                        <button class="btn btn-cart" onclick="addItem(${products[i].id})">Đặt mua</button>
                        <button class="btn btn-cart" onclick="viewProduct(${products[i].id})">Xem chi tiết</button>
                    </div>
                </div>
                `;
            }
            $("#product-body-list").html(html);
        }

        displayProducts();

        // view 1 product
        var storageKeyProducts = "products";
        localStorage.setItem(storageKeyProducts, JSON.stringify(products));

        var storageKeyViewProduct = "viewProduct";

        function viewProduct(id) {
            for (let i = 0; i < products.length; i++) {
                if (products[i].id == id) {
                    localStorage.setItem(storageKeyViewProduct, JSON.stringify(products[i]));
                }
            }
            window.location.href = "product-detail.html";
        }


        // cart local storage
        var storageKey = "cart";
        var cart = [];

        var cartItem = {
            "id": "1",
            "idProduct": "1",
            "name": "Bike",
            "price": "100",
            "discount": "10",
            "image": "assets/images/product-1.jpg",
            "quantity": "1"
        };


        function addItem(id) {
            var cart = JSON.parse(localStorage.getItem(storageKey));
            if (cart == null) {
                cart = [];
                cartItem.id = "1";
            }
            else {
                cartItem.id = cart.length + 1;
            }
            let item = products.find(function (item) {
                return item.id == id;
            });
            cartItem.idProduct = item.id;
            cartItem.name = item.name;
            cartItem.price = item.price;
            cartItem.discount = item.discount;
            cartItem.image = item.image;
            cartItem.quantity = 1;
            cart.push(cartItem);
            localStorage.setItem(storageKey, JSON.stringify(cart));
            console.log(localStorage.getItem(storageKey));
            cartHeader();
            showCart();
        }

        function resetIdCart() {
            var cart = JSON.parse(localStorage.getItem(storageKey));
            if (cart == null) {
                cart = [];
            }
            else {
                for (let i = 0; i < cart.length; i++) {
                    cart[i].id = i + 1;
                }
            }
            localStorage.setItem(storageKey, JSON.stringify(cart));
        }

        function showCart() {
            resetIdCart();
            var cart = JSON.parse(localStorage.getItem(storageKey));
            if (cart == null) {
                cart = [];
            }
            var cartList = $("#cart");
            cartList.empty();
            var total = 0;
            for (var i = 0; i < cart.length; i++) {
                var item = cart[i];
                var totalItem = item.price - item.price * item.discount / 100;
                totalItem = totalItem * item.quantity;
                var itemHtml =
                    `<tr>
                        <td>${item.id}</td>
                        <td>${item.name}</td>
                        <td><img src="${item.image}" height="40" alt=""></td>
                        <td>${item.price.toFixed(3)}đ</td>
                        <td>${item.discount}%</td>
                        <td>
                            <input id="cart${item.id}" type="number" value="${item.quantity}">
                        </td>
                        <td>${totalItem.toFixed(3)}đ</td>
                        <td><button onclick="updateItem(${item.id})">Update</button></td>
                        <td><button onclick="removeItem(${item.id})">Remove</button></td>
                        </tr>`;
                cartList.append(itemHtml);
                total += totalItem;
            }
            $("#cart-total-checkout").html(`<h3>Total: ${total.toFixed(3)}đ</h3>`);
            $("#cart-total").html(`<h3>Total: ${total.toFixed(3)}đ</h3>`);
        }

        function updateItem(id) {
            var cart = JSON.parse(localStorage.getItem(storageKey));
            var quantity = $("#cart" + id).val();
            for (var i = 0; i < cart.length; i++) {
                if (cart[i].id == id) {
                    cart[i].quantity = quantity;
                }
            }
            localStorage.setItem(storageKey, JSON.stringify(cart));
            showCart();
        }

        function removeItem(id) {
            var cart = JSON.parse(localStorage.getItem(storageKey));
            for (var i = 0; i < cart.length; i++) {
                if (cart[i].id == id) {
                    cart.splice(i, 1);
                    break;
                }
            }
            localStorage.setItem(storageKey, JSON.stringify(cart));
            cartHeader();
            showCart();
        }

        function clearCart() {
            localStorage.removeItem(storageKey);
            showCart();
            cartHeader();
        }

        function cartHeader() {
            var cart = localStorage.getItem(storageKey);
            if (cart) {
                cart = JSON.parse(cart);
                var cartTotal = 0;
                for (var i = 0; i < cart.length; i++) {
                    var item = cart[i];
                    var totalItem = item.price - item.price * item.discount / 100;
                    totalItem = totalItem * item.quantity;
                    cartTotal += totalItem;
                }
                $("#cart-count").text("Giỏ hàng(" + cart.length + ")");
                $("#cart-total").text("/ " + cartTotal.toFixed(3) + "đ");
            }
            $("#cart-mini").show();
            $("#cart-mini").css("display", "flex");
            $("#cart-mini").css("opacity", "1");
            $("#cart-mini").css("transition", "all 0.5s ease-in-out");
        }


        showCart();


    </script>
    <script src="assets/js/script.js"></script>

</body>

</html>